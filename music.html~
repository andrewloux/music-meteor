<head>
  <title>music</title>
<link href='http://fonts.googleapis.com/css?family=Knewave' rel='stylesheet' type='text/css'>
  <script>
  $(function() {
    $( "#playlist" ).sortable();
    $( "#playlist" ).disableSelection();
  });
  </script>
<script>
// Called automatically when JavaScript client library is loaded.
function onClientLoad() {
    gapi.client.load('youtube', 'v3', onYouTubeApiLoad);
}

// Called automatically when YouTube API interface is loaded
function onYouTubeApiLoad() {
    gapi.client.setApiKey('AIzaSyD1VcsNnysOY6_Za-8kE-BK6Zh8jQwvo4w');
}
</script>
  <script src="https://apis.google.com/js/client.js?onload=onClientLoad"></script>
  <script src= "https://www.youtube.com/iframe_api"></script>
  <script>
  // Load the IFrame Player API code asynchronously.
  var tag = document.createElement('script');
  tag.src = "https://www.youtube.com/player_api";
  var firstScriptTag = document.getElementsByTagName('script')[0];
  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

  // Replace the 'ytplayer' element with an <iframe> and
  // YouTube player after the API code downloads.
  var player;
  function onYouTubePlayerAPIReady() {
	console.log("playerAPIready");
    player = new YT.Player('ytplayer', {
      height: '480',
      width: '640',
      videoId: 'M7lc1UVf-VE',
      events: {
      'onReady': onPlayerReady,
      'onStateChange': onPlayerStateChange
      }
    });
 
 //console.log("loaded");
  $("#player").hide();
  }

function onPlayerReady(){
//console.log("ready");
}

function onPlayerStateChange(){
//console.log("changed");

}

function generatePlaylist(list){
	console.log("list: ", list)
	player.loadPlaylist(list);
}
  </script>
</head>

<body>
  {{> header}}
  {{> search_bar}}
  {{> player}}
  {{> list}}
  {{> generate}}
</body>

<template name="header">
  <h1 id="title">mixtape</h1>
</template>

<template name="search_bar">
  <input id="query" type="text" placeholder="Journey - Don't Stop Believin'" />
</template>

<template name="list">
  <ul id="playlist">
    {{#each my_playlist}}
           {{> track}}
    {{/each}}	
  </ul>
</template>

<template name="generate">
	<button type="button" id="generate_button" >Hear mixtape</button>
</template>

<template name="player">
	<div id="player">
		<div id="ytplayer"></div>
		<div id="nav">
		    <button id="close_player">close</button>
		    {{#each my_playlist}}
		          {{> unremovable_track}}
		    {{/each}}	
		</div>
	</div>
</template>

<template name="track">
<li id="{{_id}}" class="list_element">
<!-- Have to make proper track <li> element.
    <div class="thumbnail" style="background-image:url('{{thumbnail}}')"></div>
-->
    <div class="destroy"> </div>
    <div class="element_style">{{song_title}}</div>
</li>
</template>

<template name="unremovable_track">
<li class="unremovable list_element">
<!-- Have to make proper track <li> element.
    <div class="thumbnail" style="background-image:url('{{thumbnail}}')"></div>
-->
    <div class="element_style">{{song_title}}</div>
</li>
</template>

